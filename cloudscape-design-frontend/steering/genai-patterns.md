# Cloudscape GenAI Patterns

Components and patterns for building generative AI interfaces.

## GenAI Components

| Component | Purpose |
|-----------|---------|
| Avatar | Visual representation of user/AI |
| ChatBubble | Display messages in conversations |
| PromptInput | Text input for AI prompts |
| LoadingBar | Indicate AI processing/generation |
| SupportPromptGroup | Suggested prompts/actions |

## Avatar

```jsx
import { Avatar } from '@cloudscape-design/components';

// User avatar
<Avatar name="John Doe" variant="user" size="medium" />

// AI avatar
<Avatar name="AI Assistant" variant="default" size="medium" />

// Loading state (AI thinking)
<Avatar loading />

// Sizes: small, medium, large
<Avatar name="AI" size="large" />
```

## ChatBubble

```jsx
import { ChatBubble, Avatar, SpaceBetween, Box } from '@cloudscape-design/components';

// User message
<ChatBubble
  type="user"
  content="How do I create an S3 bucket?"
  header={
    <SpaceBetween direction="horizontal" size="xs">
      <Avatar name="You" variant="user" size="medium" />
      <span>You</span>
    </SpaceBetween>
  }
  footer={<Box fontSize="body-s" color="text-body-secondary">10:32 AM</Box>}
/>

// AI message
<ChatBubble
  type="ai"
  content="To create an S3 bucket, you can use the AWS Console or CLI..."
  header={
    <SpaceBetween direction="horizontal" size="xs">
      <Avatar name="AI" variant="default" size="medium" />
      <span>AI Assistant</span>
    </SpaceBetween>
  }
/>

// AI message with loading
<ChatBubble
  type="ai"
  content={<LoadingBar />}
  header={...}
/>
```

## PromptInput

```jsx
import { PromptInput } from '@cloudscape-design/components';

const [value, setValue] = useState('');
const [isSubmitting, setIsSubmitting] = useState(false);

<PromptInput
  value={value}
  onChange={({ detail }) => setValue(detail.value)}
  onSubmit={handleSubmit}
  expandable={true}
  submitting={isSubmitting}
  stickyBottom={true}
  i18nStrings={{
    submitAriaLabel: 'Send message',
    expandAriaLabel: 'Expand input',
    inputPlaceholder: 'Ask me anything...',
    submitButtonText: 'Send'
  }}
/>
```

### With File Attachments

```jsx
const [files, setFiles] = useState([]);

<PromptInput
  value={value}
  onChange={({ detail }) => setValue(detail.value)}
  onSubmit={handleSubmit}
  fileAttachmentOptions={{
    accept: '.pdf,.doc,.txt,.png,.jpg',
    maxFileSize: 5 * 1024 * 1024,
    maxFilesCount: 3,
    value: files,
    onChange: ({ detail }) => setFiles(detail.value),
    i18nStrings: {
      uploadButtonText: () => 'Attach files',
      dropzoneText: () => 'Drop files here',
      removeFileAriaLabel: (file) => `Remove ${file.name}`,
    }
  }}
/>
```

## LoadingBar

```jsx
import { LoadingBar } from '@cloudscape-design/components';

// In chat bubble during AI response
<ChatBubble
  type="ai"
  content={
    <SpaceBetween size="s">
      <LoadingBar />
      <Box color="text-body-secondary">Generating response...</Box>
    </SpaceBetween>
  }
/>
```

## GenAI Loading States

### Processing Stage (no output yet)

```jsx
<ChatBubble
  type="ai"
  content={
    <SpaceBetween direction="horizontal" size="xs">
      <Avatar loading />
      <Box>Generating a response</Box>
    </SpaceBetween>
  }
/>
```

### Generation Stage (streaming)

```jsx
// Stream text as it's generated
const [streamedText, setStreamedText] = useState('');

<ChatBubble
  type="ai"
  content={
    <>
      {streamedText}
      {isStreaming && <LoadingBar />}
    </>
  }
/>
```

### Loading Non-Text Content

```jsx
// For tables, code blocks, lists
<ChatBubble
  type="ai"
  content={
    <SpaceBetween size="m">
      <Box>Here are your EC2 instances:</Box>
      <LoadingBar />
      <Box color="text-body-secondary">Loading list of resources</Box>
    </SpaceBetween>
  }
/>
```

## GenAI Ingress (Entry Points)

```jsx
import { Button, Icon } from '@cloudscape-design/components';

// Primary GenAI button
<Button variant="primary" iconAlign="left" iconName="gen-ai">
  Ask AI Assistant
</Button>

// Normal GenAI button
<Button iconAlign="left" iconName="gen-ai">
  Generate content
</Button>
```

## GenAI Output Label

```jsx
import { Box, Icon } from '@cloudscape-design/components';

// Label AI-generated content
<Box variant="awsui-gen-ai-label">
  <Icon name="gen-ai" size="small" />
  Generated by AI
</Box>
```

## SupportPromptGroup

Suggested prompts for users:

```jsx
import { SupportPromptGroup } from '@cloudscape-design/components';

<SupportPromptGroup
  items={[
    { text: 'How do I create an S3 bucket?', id: 'prompt-1' },
    { text: 'Show me my EC2 instances', id: 'prompt-2' },
    { text: 'What are best practices for IAM?', id: 'prompt-3' },
  ]}
  onItemClick={({ detail }) => handlePromptClick(detail.id)}
  ariaLabel="Suggested prompts"
/>
```

## Complete Chat Interface

```jsx
import {
  ChatBubble, Avatar, PromptInput, LoadingBar,
  Container, Header, SpaceBetween, Box
} from '@cloudscape-design/components';

function ChatInterface() {
  const [messages, setMessages] = useState([]);
  const [input, setInput] = useState('');
  const [isLoading, setIsLoading] = useState(false);
  const chatEndRef = useRef(null);

  useEffect(() => {
    chatEndRef.current?.scrollIntoView({ behavior: 'smooth' });
  }, [messages]);

  const handleSubmit = async () => {
    if (!input.trim()) return;

    // Add user message
    setMessages(prev => [...prev, { type: 'user', content: input }]);
    setInput('');
    setIsLoading(true);

    // Simulate AI response
    setTimeout(() => {
      setMessages(prev => [...prev, {
        type: 'ai',
        content: 'Here is my response to your question...'
      }]);
      setIsLoading(false);
    }, 2000);
  };

  return (
    <Container header={<Header variant="h2">AI Assistant</Header>}>
      <SpaceBetween size="l">
        <Box style={{ height: '400px', overflowY: 'auto' }}>
          {messages.map((msg, i) => (
            <ChatBubble
              key={i}
              type={msg.type}
              content={msg.content}
              header={
                <SpaceBetween direction="horizontal" size="xs">
                  <Avatar
                    name={msg.type === 'user' ? 'You' : 'AI'}
                    variant={msg.type === 'user' ? 'user' : 'default'}
                  />
                  <span>{msg.type === 'user' ? 'You' : 'AI Assistant'}</span>
                </SpaceBetween>
              }
            />
          ))}

          {isLoading && (
            <ChatBubble
              type="ai"
              content={<LoadingBar />}
              header={
                <SpaceBetween direction="horizontal" size="xs">
                  <Avatar name="AI" variant="default" loading />
                  <span>AI Assistant</span>
                </SpaceBetween>
              }
            />
          )}

          <div ref={chatEndRef} />
        </Box>

        <PromptInput
          value={input}
          onChange={({ detail }) => setInput(detail.value)}
          onSubmit={handleSubmit}
          submitting={isLoading}
          expandable
          stickyBottom
          i18nStrings={{
            submitAriaLabel: 'Send',
            inputPlaceholder: 'Ask me anything...',
          }}
        />
      </SpaceBetween>
    </Container>
  );
}
```

## Writing Guidelines

### Loading Messages

- Use format: `[Generating/Loading] [specific artifact]`
- "Generating" for new content: `Generating a response`
- "Loading" for existing data: `Loading list of S3 buckets`
- No end punctuation

### AI Terminology

- Refer to AI as "generative AI assistant"
- User queries: use "submit" not "send"
- AI replies: use "responses" not "answers"

## Best Practices

1. Show loading state immediately after user submits
2. Stream text responses when model supports it
3. Use LoadingBar for non-text content (tables, code blocks)
4. Don't show loading for < 1 second (causes flickering)
5. Always pair loading indicators with loading text
6. Label AI-generated content with GenAI label
7. Provide suggested prompts for new users
8. Auto-scroll to latest message
9. Allow expanding input for longer prompts
10. Support file attachments when relevant
